Fixed :class:`RecursionError` caused by certain corner cases in the scheduler.
